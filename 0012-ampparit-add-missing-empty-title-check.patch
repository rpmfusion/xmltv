From 68126caa72a652a3d396d62ce64c215c680e2f79 Mon Sep 17 00:00:00 2001
From: Stefan Becker <chemobejk@gmail.com>
Date: Mon, 16 Nov 2020 21:40:55 +0200
Subject: [PATCH 12/50] ampparit: add missing empty title check

Programmes must have a valid title.
---
 grab/fi/fi/source/ampparit.pm | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)

diff --git a/grab/fi/fi/source/ampparit.pm b/grab/fi/fi/source/ampparit.pm
index 8d2768e9..223a582a 100644
--- a/grab/fi/fi/source/ampparit.pm
+++ b/grab/fi/fi/source/ampparit.pm
@@ -135,13 +135,16 @@ sub grab {
 	    if (my($hour, $minute) =
 		$start->as_text() =~ /^(\d{2})[:.](\d{2})$/) {
 	      $title = $title->as_text();
-	      $desc  = $desc->as_text();
 
-	      debug(3, "List entry ${id} ($hour:$minute) $title");
-	      debug(4, $desc) if $desc;
+	      if (length($title)) {
+		$desc  = $desc->as_text();
 
-	      my $object = appendProgramme($opaque, $hour, $minute, $title);
-	      $object->description($desc);
+		debug(3, "List entry ${id} ($hour:$minute) $title");
+		debug(4, $desc) if $desc;
+
+		my $object = appendProgramme($opaque, $hour, $minute, $title);
+		$object->description($desc);
+	      }
 	    }
 	  }
 	}
-- 
2.29.2

